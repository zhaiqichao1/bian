# 比特币价格预测系统

这是一个基于深度学习的比特币价格预测系统，集成了马丁格尔策略、技术指标过滤和情绪分析。

## 🚀 主要特点

- **高级预测系统**：
  - 双向LSTM+Attention模型
  - 集成学习（多模型投票）
  - 自动特征工程
  - 置信度评分系统

- **严格的技术指标过滤**：
  - RSI超买超卖检查
  - MACD方向验证
  - 布林带位置检查
  - 趋势方向确认
  - 成交量确认

- **风险管理系统**：
  - 马丁格尔投注策略
  - 每日最大亏损限制
  - 单笔止损/止盈
  - 动态仓位管理

- **市场情绪分析**：
  - 大单交易检测
  - 恐慌贪婪指数整合
  - 社交媒体情绪分析

## 📊 马丁格尔策略

系统实现了改进的马丁格尔投注策略：

1. 初始投注5U，赢则继续投注5U
2. 输则翻倍投注：5U→10U→30U→90U→250U
3. 任何时候赢了都重置回5U

此策略在亏损时增加投注额，但有严格的风控机制防止过度亏损。

## 🔍 大单交易检测

系统会实时监控交易所的大单交易：

- 自动调整的大单阈值（默认0.5 BTC）
- 区分"所有最近交易"和"最近1分钟内"的大单
- 提供大单买入/卖出压力指标

## 🧠 预测系统改进

最新版本的预测系统有以下改进：

1. **严格的技术指标过滤**：
   - 只有当技术指标与预测方向一致时才执行交易
   - 多重技术指标验证（RSI、MACD、布林带、均线、成交量）
   - 自动识别超买超卖区域

2. **增强的特征工程**：
   - 新增50+技术指标特征
   - 市场情绪特征整合
   - 时间特征和交易活跃度分析

3. **模型训练可视化**：
   - 训练曲线图表
   - 模型收敛监控
   - 学习率自动调整

4. **置信度阈值提高**：
   - 默认置信度阈值从60%提高到75%
   - 动态置信度调整系统

## 最新优化

### 1. 技术指标评分系统

我们实现了一个更智能的技术指标评分机制，替代了原来的简单"通过/不通过"过滤逻辑：

- **MACD增强**：不仅考虑柱状图值，还结合了DIF与DEA的交叉点判断
- **布林带增强**：加入了对布林带突破的判断，并考虑布林带宽度扩张情况
- **评分制**：每个技术指标给出-3到+3的评分，最终综合评分决定交易信号
- **可配置阈值**：通过config.py设置技术指标评分阈值

### 2. 配置系统优化

创建了全面的config.py配置文件，将配置分为多个逻辑模块：

- API配置
- 交易参数
- 马丁格尔策略参数
- 模型参数
- 技术指标参数
- 情绪分析参数
- 系统参数

### 3. 置信度提升

- 提高了最低置信度门槛从60%到75%
- 技术指标评分直接影响置信度计算

## 系统组件

- **EnhancedLSTMModel**: 双向LSTM模型，带注意力机制
- **EnhancedDataProcessor**: 数据处理器，支持多时间周期特征
- **BitcoinPredictor**: 预测引擎，集成多模型预测
- **MarketSentimentAnalyzer**: 市场情绪分析器

## 📈 使用方法

### 安装依赖

```bash
pip install -r requirements.txt
```

### 配置

编辑`config.py`文件，设置您的API密钥和交易参数：

```python
# 示例配置
config = {
    'api_key': 'YOUR_API_KEY',
    'api_secret': 'YOUR_API_SECRET',
    'symbol': 'BTCUSDT',
    'timeframe': '1m',
    'test_mode': True,  # 设为False进行实盘交易
    'trade_enabled': False,  # 设为True启用自动交易
    'min_confidence_threshold': 75,  # 置信度阈值
    'tech_filter_enabled': True,  # 技术指标过滤
}
```

### 运行

```bash
python main.py
```

### 交互命令

系统支持以下交互命令：

- `predict` - 执行一次预测
- `train` - 重新训练模型
- `stats` - 显示交易统计
- `config` - 显示当前配置
- `exit` - 退出程序

## ⚠️ 风险提示

加密货币交易具有高风险性。本系统仅供学习和研究使用，不构成投资建议。使用本系统进行实盘交易时，请注意以下几点：

1. 始终使用您能够承受损失的资金
2. 从小额开始测试系统
3. 定期监控系统性能
4. 了解马丁格尔策略的风险

## 📈 技术指标评分详解

系统使用以下指标进行评分：

1. **RSI (相对强弱指标)**
   - 上涨时：RSI>70(-2分)，RSI>60(+1分)，RSI<30(+2分)
   - 下跌时：RSI<30(-2分)，RSI<40(+1分)，RSI>70(+2分)

2. **MACD (移动平均线收敛发散)**
   - 上涨时：MACD柱状图>0(+2分)，MACD柱状图<0(-2分)，DIF>DEA(+1分)
   - 下跌时：MACD柱状图<0(+2分)，MACD柱状图>0(-2分)，DIF<DEA(+1分)

3. **布林带**
   - 上涨时：价格>上轨且带宽扩张(+1分)，价格>上轨且带宽正常(-1分)，价格<下轨(+2分)
   - 下跌时：价格<下轨且带宽扩张(+1分)，价格<下轨且带宽正常(-1分)，价格>上轨(+2分)

4. **移动平均线**
   - 上涨时：价格>MA20(+1分)，价格<MA20(-1分)，MA20>MA50(+1分)
   - 下跌时：价格<MA20(+1分)，价格>MA20(-1分)，MA20<MA50(+1分)

5. **成交量**
   - 成交量>均值*1.2(+1分)
   - 成交量<均值*0.7(-1分)

总分在-10到+10之间，默认阈值为+2分，低于此分数将不推荐交易。

## �� 许可证

MIT License 